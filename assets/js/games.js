// games.js
let questions=[]; let idx=0; let coins=Number(localStorage.getItem('endue_coins')||0); let wrong=0;
const mascots=['ğŸ“˜','âœï¸','ğŸ§ ','ğŸˆ','ğŸ–ï¸']; const ads=['assets/images/ad1.svg','assets/images/ad2.svg','assets/images/ad3.svg'];
document.addEventListener('DOMContentLoaded', ()=>{ const start = document.getElementById('startGameBtn'); if(start) start.addEventListener('click', startGame); const cd = document.getElementById('coinDisplay'); if(cd) cd.textContent = `ğŸª™ Knowledge Coins: ${coins}`; });
async function startGame(){ const s = document.getElementById('subjectSelect').value; if(!s){ alert('Choose subject'); return;} const res = await fetch(`assets/data/questions_${s}.json`); questions = await res.json(); idx=0; wrong=0; document.getElementById('gameBox').style.display='block'; document.getElementById('adSection').style.display='block'; loadQ(); }
function loadQ(){ if(!questions.length) return; const q=questions[idx]; document.getElementById('question').textContent=q.q; const opts=document.getElementById('options'); opts.innerHTML=''; q.options.forEach(o=>{ const b=document.createElement('button'); b.textContent=o; b.addEventListener('click', ()=>answer(o)); opts.appendChild(b); }); }
function answer(selected){ const q=questions[idx]; if(selected===q.answer){ coins++; localStorage.setItem('endue_coins', coins); document.getElementById('coinDisplay').textContent = `ğŸª™ Knowledge Coins: ${coins}`; document.getElementById('donationProgress').textContent = `ğŸ Youâ€™ve donated ${Math.floor(coins/5)} virtual books!`; reward(); rotateAd(); wrong=0; } else { wrong++; showFloating(wrong===3 ? 'Visit lessons and come back!' : 'Nice try! Keep going!'); if(wrong>=3) showRobot(); } idx=(idx+1)%questions.length; setTimeout(loadQ,600); }
function reward(){ const m=document.getElementById('mascot'); m.textContent = mascots[Math.floor(Math.random()*mascots.length)]; m.classList.add('mascot-animate'); setTimeout(()=>m.classList.remove('mascot-animate'),700); const cont=document.createElement('div'); cont.className='reward-container'; const icons=['âœï¸','ğŸ“š','ğŸ–ï¸','ğŸ“’','â­']; for(let i=0;i<7;i++){ const s=document.createElement('span'); s.className='reward-icon'; s.textContent=icons[Math.floor(Math.random()*icons.length)]; s.style.left=(5+Math.random()*90)+'%'; cont.appendChild(s); } document.body.appendChild(cont); setTimeout(()=>cont.remove(),1400); if(typeof tinyConfetti==='function') tinyConfetti(); }
function showFloating(txt){ const el=document.createElement('div'); el.className='floating-message'; el.textContent=txt; document.body.appendChild(el); setTimeout(()=>el.remove(),2500); }
function rotateAd(){ const img=document.getElementById('adImage'); if(img) img.src = ads[Math.floor(Math.random()*ads.length)]; }
function showRobot(){ const bot=document.getElementById('robotTutor'); const msg=document.getElementById('robotMessage'); if(!bot||!msg) return; bot.style.display='block'; msg.style.display='block'; msg.classList.add('slide-in'); setTimeout(()=>{ msg.classList.remove('slide-in'); msg.style.display='none'; bot.style.display='none'; },6500); }
